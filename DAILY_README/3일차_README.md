# 3ì¼ì°¨

# ë¥˜ì›ì°½

ê°œë°œëª©ë¡: ìœ ì € ê¸°ëŠ¥ ê´€ë ¨
ë‚ ì§œ: 2022ë…„ 11ì›” 18ì¼

í•  ì¼

- [x] íšŒì›ê°€ì…, ë¡œê·¸ì¸, ì •ë³´ìˆ˜ì • í˜ì´ì§€ ìœ íš¨ì„±ê²€ì‚¬, ë¼ìš°íŒ… ê°€ë“œ ì„¤ì •
- [ ] ë„¤ë¸Œë°” ë§Œë“¤ê¸°

# íšŒì›ê°€ì… í˜ì´ì§€ ìœ ì €ë„¤ì„, íŒ¨ìŠ¤ì›Œë“œ ìœ íš¨ì„± ê²€ì‚¬

- íšŒì›ê°€ì… í˜ì´ì§€ì—ì„œ, ìœ ì €ë„¤ì„ê³¼ íŒ¨ìŠ¤ì›Œë“œì— ëŒ€í•´ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ê³  ì ì ˆí•˜ê²Œ ë°‘ì—
- ë¹„ë°€ë²ˆí˜¸ê°€ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤ ë“±ì„ ë„ìš°ê³  ì‹¶ë‹¤.
- í•˜ì§€ë§Œ, ì¢€ í•´ë³´ë‹ˆ ì–´ë ¤ìš´ ì‘ì—…ì´ë‹¤.
- ì¼ë‹¨, usernameì— ëŒ€í•´ ì´ë¯¸ ìˆëŠ” ì´ë¦„ì´ë©´ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤ê³  ë°‘ì— ë©”ì„¸ì§€ë¥¼ ë„ìš°ì

### ìœ ì €ë„¤ì„ ìœ íš¨ì„± ê²€ì‚¬

- ìœ ì €ë„¤ì„ì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ëŠ” ê²ƒì€ í¬ê²Œ ë‘ ê°€ì§€ë‹¤
- í•˜ë‚˜ëŠ” ë„ˆë¬´ ì§§ì€ ì´ë¦„, ë˜ í•˜ë‚˜ëŠ” ì´ë¯¸ ìˆëŠ” ê²½ìš°
- ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” ì´ë¯¸ ìˆëŠ” ê²½ìš°ë§Œ ì²´í¬í•˜ë„ë¡ í•˜ì.
- ê·¸ê±¸ ìœ„í•´ accountsStoreì˜ stateì— usernamesë¼ëŠ” ë¹ˆ ë°°ì—´ì„ í•˜ë‚˜ ë§Œë“¤ê³  íšŒì›ê°€ì… í•  ë•Œ ë§ˆë‹¤
- usernameì„ pushí•´ì£¼ì
- ê·¸ëŸ¬ê³  usernamesë¥¼ íšŒì›ê°€ì… í˜ì´ì§€ì˜ computedì†ì„±ì— ê°€ì§€ê³  ì™€ì„œ ë¹„êµë¥¼ í•œë‹¤.

![Untitled]3ì¼ì°¨_ë¥˜ì›ì°½.png)

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%201.png)

ì´ëŸ° ì‹ìœ¼ë¡œ ì‘ì—…í•œë‹¤.

### ìœ ì €ë„¤ì„ ìœ íš¨ì„± ê²€ì‚¬ ì™„ë£Œ

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%202.png)

### ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ ì™„ë£Œ

- ì‚¬ì‹¤ì€ ì¢€ ë” ì´ì˜ê²Œ ê¾¸ë¯¸ê³  ì‹¶ì—ˆìœ¼ë‚˜, ì§€ê¸ˆì˜ cssì‹¤ë ¥ìœ¼ë¡  ë¬´ë¦¬ë¼ê³  íŒë‹¨
- ë‹¨ìˆœ ë¹„ë°€ë²ˆí˜¸ì˜ ê¸€ì ìˆ˜ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ë³´ì—¬ì¤Œ

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%203.png)

# ë¡œê·¸ì¸ ì—¬ë¶€ì— ë”°ë¥¸ ë¼ìš°í„° ê°€ë“œ ì„¤ì •

- ë¡œê·¸ì¸ í•œ ìœ ì €ë¼ë©´ íšŒì›ê°€ì…ê³¼ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ëª»ê°€ê²Œ í•´ì•¼í•˜ê³ 
- ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ìœ ì €ë¼ë©´ ì •ë³´ìˆ˜ì • í˜ì´ì§€ì™€ í”„ë¡œí•„ í˜ì´ì§€ì— ê°€ì§€ ëª»í•˜ê²Œ í•´ì•¼í•œë‹¤.

### ì „ì—­ ê°€ë“œ

- ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ íŠ¹ì • í˜ì´ì§€ì— ê°€ì§€ ëª»í•˜ê²Œí•œë‹¤.

router/index.js

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%204.png)

### ë¼ìš°í„° ê°€ë“œ

- ì´ì œ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìëŠ” íšŒì›ê°€ì…ê³¼ ë¡œê·¸ì¸ í˜ì´ì§€ì— ì ‘ê·¼í•˜ì§€ ëª»í•˜ê²Œ í•´ì•¼í•˜ëŠ”ë°,
- ë¼ìš°í„°ì˜ index.jsì—ì„œ ë¡œê·¸ì¸ì„ í•œ ì—¬ë¶€ë¥¼ ì–´ë–»ê²Œ í™•ì¸í•´ì•¼í• ì§€ ì˜ ëª¨ë¥´ê² ë‹¤.
- ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ëŠ” vuexë¡œ ì•±ë§ˆë‹¤ ë‚˜ëˆ„ì–´ì ¸ì„œ ì œì´ìŠ¨ìœ¼ë¡œ ì €ì¥ë˜ì–´ì„œ ì´ê±¸ ê°ì²´ë¡œ í’€ê³  í•˜ë©´ ë  ê²ƒê°™ê¸´ í•œë°,
- ê·¸ëƒ¥ ë¡œê·¸ì¸í˜ì´ì§€ì™€ íšŒì›ê°€ì…í˜ì´ì§€ì˜ creaetdì— ë¡œê·¸ì¸ í–ˆìœ¼ë©´ â€˜/â€™ìœ¼ë¡œ ì´ë™ í•˜ë„ë¡ í–ˆë‹¤.

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%205.png)

## ë¬¸ì œ ë¼ìš°í„°ì˜ index.jsì—ì„œ ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸

- ê°œë³„ vueíŒŒì¼ì—ì„œëŠ” vuexì˜ index.jsì—ì„œ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìœ¼ë‚˜,
- ë¼ìš°í„°ì˜ index.jsì—ì„  ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ëœ ê°’ì„ ê°€ì ¸ì™€ì•¼í•œë‹¤.
- í•˜ì§€ë§Œ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ëŠ” jsoní˜•íƒœë¥¼ ê°€ì§„ ê°ì²´ê°€ ì €ì¥ë˜ì–´ ìˆë‹¤.
- ì´ë¥¼ ì˜ ì ‘ê·¼í•˜ë©´ ë˜ê² ë‹¤.

## ë¼ìš°í„° ë¬¸ì œ í•´ê²°

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%206.png)

- ìœ„ì˜ ë°©ì‹ëŒ€ë¡œ ì¡°íšŒë¥¼ í•˜ë©´ ê°œë³„ tokenì˜ ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

# ë„¤ë¸Œë°” ë§Œë“¤ê¸°

- ì´ì œ ìœ ì € ê´€ë ¨ì—ì„œ ë²—ì–´ë‚˜ ë©”ì¸ì¸ ì˜í™”ì— ê´€ë ¨í•œ í˜ì´ì§€ë¥¼ êµ¬ì¶•í•´ì•¼í•œë‹¤.
- ì¼ë‹¨, ë„¤ë¸Œë°”ë¥¼ ë§Œë“¤ì–´ ë³´ì

### ì´ˆì•ˆ 1

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%207.png)

- ì•„ì§ ëˆ„ë¥´ë©´ ì´ë™í•˜ëŠ” ê¸°ëŠ¥ì€ ì—†ë‹¤
- ê»ë°ê¸° ì½”ë“œì´ë‹¤

### ì´ˆì•ˆ 2

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%208.png)

- ì˜¤ë¥¸ìª½ì— ìœ ì € í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ ë†“ê³ , ëˆ„ë¥´ë©´ ë“œë¡­ë‹¤ìš´ í˜•íƒœë¡œ ë§í¬ë“¤ì´ ëœ¨ëŠ” ê²ƒì„ ë§Œë“¤ì—ˆë‹¤.
- ì´ì œ ì´ˆì•ˆ 2ì˜ í”„ë¡œí•„ ì´ë¯¸ì§€ ì½”ë“œë¥¼ ì´ˆì•ˆ 1ì˜ ë§¨ ì˜¤ë¥¸ìª½ì— ë¶™ì´ë©´ ë˜ê² ë‹¤.
- ë§¨ ì˜¤ë¥¸ìª½ì—ëŠ” ë¡œê·¸ì¸ì„ ì•ˆí•œ ê²½ìš°ëŠ” ë¡œê·¸ì¸ì„ í•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì„ ë³´ì—¬ì£¼ê³ 
- ë¡œê·¸ì¸ì„ í–ˆë‹¤ë©´ í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì£¼ë©´ ë˜ê² ë‹¤.

## ë„¤ë¸Œë°” ëŒ€ì¶© ì™„ì„±

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%209.png)

![Untitled](3ì¼ì°¨_ë¥˜ì›ì°½/Untitled%2010.png)

- ìœ ì €ê°€ ë¡œê·¸ì¸ í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¡œê·¸ì¸ê³¼ íšŒì›ê°€ì… ë²„íŠ¼ì„ ë³´ì—¬ì£¼ê³ 
- ë¡œê·¸ì¸ í–ˆë‹¤ë©´ ìœ ì €ì˜ í”„ë¡œí•„ì„ ë³´ì—¬ì¤€ë‹¤.
- ìœ ì €ì˜ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ë©´ ë“œëë‹¤ìš´ì´ ë‚˜ì˜¤ë©° í´ë¦­ì‹œ í•´ë‹¹ ë§í¬ë¡œ ì´ë™í•œë‹¤.

&nbsp;
...  
...  

# ì´ì§€ì€

ê°œë°œëª©ë¡: django
ë‚ ì§œ: 2022ë…„ 11ì›” 18ì¼

- [x] django - vue ì—°ë™í•˜ì—¬ movie detail  ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
- [x] django review ëª¨ë¸ ì •ì˜ â‡’
- [ ] 11.19 ì— good_user / bad_user ë‹¤ì‹œ ì •ì˜
- [x] review CRUD
- [ ] django - vue ì—°ë™í•˜ì—¬ movie detail  í˜ì´ì§€ì—ì„œ ë¦¬ë·° CRUD â†’ ì¡°íšŒë§Œ ì™„ì„±
- [x] README_ 3ì¼ì°¨ ì†Œê° ğŸ“•

## DB â†’ Vue / movie detail  ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°

### â€¦mapActions ì¸ì ë„˜ê¸°ê¸° ë¬¸ì œ í•´ê²°

movie detail í˜ì´ì§€ë¡œ ì´ë™ ì‹œ `mapActionsì— â€˜movieIdâ€™` ì¸ì í•¨ê»˜ ë„˜ê²¨ì£¼ê¸°

```jsx
const moviesStore = 'moviesStore'

export default {
  name: 'MovieDetailInfoView',
  computed: {
    ...mapGetters(moviesStore, ['movie']),
  },
  methods: {
    ...mapActions(moviesStore, ['getMovieDetail']),
  },
  created() {
    const movieId = this.$route.params.id
    this.getMovieDetail(movieId)
  }
}
```

paramsë¡œ ë„˜ê²¨ ë°›ì€ ì¸ìë¥¼ store/modules/moviesStoreì˜ actions ì¸ìë¡œ ë„˜ê²¨ ì£¼ê¸°.

 ë³€ìˆ˜ë¡œ ì„ ì–¸ í›„ì—   `this.getMovieDetail(movieId)` ì²˜ë¦¬

## Review ëª¨ë¸ ì •ì˜

**back-end/movies/models.py**

```python
class Review(models.Model):
    movie = models.ForeignKey(Movie, on_delete=models.CASCADE)
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name='reviews')
    rank = models.IntegerField(validators=[MinValueValidator(0), MaxValueValidator(5)])
    good_user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, null=True, related_name='good_reviews')
    bad_user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, null=True, related_name='bad_reviews')
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
```

![Untitled](3ì¼ì°¨_ì´ì§€ì€/Untitled.png)

movie - review â‡’

- review-movie â‡’ 1:N
- reivew-user â‡’ 1:N
- review-good_user â‡’ 1:N
- review-bad_user â‡’ 1:N

rank â‡’ ì˜í™” í‰ì 

good_user â‡’ ë¦¬ë·° ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥¸ ì‚¬ìš©ì

bad_user â‡’ ë¦¬ë·° ì‹«ì–´ìš”ë¥¼ ëˆ„ë¥¸ ì‚¬ìš©ì 

â€”>ìœ ì €ê°€ N / review ê°€ 1 dls 1:N ê´€ê³„ =â‡’ User Model ì—ì„œ FK ë‹¤ì‹œ ì •ì˜ 

## Review(CRUD)

**back-end/movies/views.py**

```python
# movie_Detail -> ì „ì²´ ë¦¬ë·° ì¡°íšŒ(GET) ë¦¬ë·° ìƒì„±(POST)
@api_view(['GET', 'POST'])
@permission_classes([IsAuthenticatedOrReadOnly])
def review_list_create(request, movie_pk):
  if request.method == 'GET':
    reviews = Review.objects.filter(movie_id=movie_pk)
    # ì™¸ë˜í‚¤ì˜ movie_idê°€ movie_pkì™€ ì¼ì¹˜í•˜ëŠ” ê²½ìš° .filter(movie_id=movie_pk)
    serializer = ReviewListSerializer(reviews, many=True)
    # ë³µìˆ˜ ê°ì²´
    return Response(serializer.data)
  else:
  # ìƒì„±(POST)
    movie = get_object_or_404(Movie, pk=movie_pk)
    serializer = ReviewSerializer(data=request.data)
    if serializer.is_valid(raise_exception=True):
        serializer.save(user=request.user, movie = movie)
        # user, movie ì™¸ë˜í‚¤ ì°¸ì¡° ê°ì²´ ì„¤ì •
        return Response(serializer.data, status=status.HTTP_201_CREATED)

@api_view(['GET', 'DELETE', 'PUT'])
@permission_classes([IsAuthenticatedOrReadOnly])
def review_detail(request, review_pk):
# movie_Detail -> ë¦¬ë·° ì¡°íšŒ(GET), ìˆ˜ì •(PUT), ì‚­ì œ(DELETE)
    review = get_object_or_404(Review, pk=review_pk)
    if request.method == 'GET':
        serializer = ReviewSerializer(review)
        return Response(serializer.data)
    else:
        if request.user == review.user:
            # ì‘ì„±ìì™€ ê°™ì€ ê²½ìš°
            if request.method == 'DELETE':
                review.delete()
                data = {
                    f'{review_pk}ë²ˆ ë¦¬ë·°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.'
                }
                return Response(data, status=status.HTTP_204_NO_CONTENT)
            if request.method == 'PUT':
                serializer = ReviewSerializer(review, data=request.data)
                if serializer.is_valid(raise_exception=True):
                    serializer.save()
                    return Response(serializer.data)
        else:
            return Response(status=status.HTTP_403_FORBIDDEN)
            # ì‘ì„±ìì™€ ë‹¤ë¥¸ ê²½ìš°
```

## postman ì„ ì´ìš©í•˜ì—¬ DBì— review ì‘ì„±í•˜ê¸°

### ****Error Response****

**HTTP Status Code**

`401 Unauthorized`

-ë¡œê·¸ì¸ ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì—ê²Œ ìš”ì²­ì´ ë“¤ì–´ì˜¬ ê²½ìš° / ë¡œê·¸ì¸ ì •ë³´ê°€ ì˜ëª»ëœ ê²½ìš°

```
{
"detail": "ìê²© ì¸ì¦ë°ì´í„°(authentication credentials)ê°€ ì œê³µë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."
}
```

### ERR í•´ê²° ë°©ì•ˆ

### **Permission**

`IsAuthenticatedOrReadOnly`

ì¸ì¦ëœ userë§Œ ìš”ì²­ì— ì„±ê³µ í•  ìˆ˜ ìˆìœ¼ë©°,  ì¸ì¦ë˜ì§€ ì•Šì€ userëŠ” ì½ê¸°(methodÂ `GET`)ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.

**Tokenì¸ì¦ ë°©ë²•**

ì•„ë˜ì™€ ê°™ì´ í—¤ë”ì— Tokenê°’ì„ ì…ë ¥í•˜ì—¬ ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.

![Untitled](3ì¼ì°¨_ì´ì§€ì€/Untitled%201.png)

![Untitled](3ì¼ì°¨_ì´ì§€ì€/Untitled%202.png)

**â‡’ ì •ìƒ ì‘ë‹µ í™•ì¸**

â†’ ì´ ë•Œ good_user ê³¼ bad_userì˜ FK ì— null=True ë¥¼ í•´ ì¤„ ê²½ìš° ë¹ˆ ê°’ ì‚¬ìš© ê°€ëŠ¥

## 

## ğŸ“•3ì¼ì°¨ ì†Œê°

 3ì¼ì°¨ê°€ ë˜ì–´ì„œì•¼ í”„ë¡œì íŠ¸ ì§„í–‰ì— íƒ„ë ¥ì„ ë°›ì€ ëŠë‚Œì´ë‹¤. 

1, 2 ì¼ì°¨ì—ëŠ” í”„ë¡œì íŠ¸ ì§„í–‰ ì†ë„ê°€ ëŠë ¸ê³  README ì •ë¦¬ë„ ìƒê°í•œ ë§Œí¼ ì˜ í•˜ì§€ ëª»í–ˆë‹¤.

ì§‘ì—ì„œ í”„ë¡œì íŠ¸í•œ ê²ƒì´ ê°•ì˜ì‹¤ì—ì„œ ë³´ë‹¤ ì—…ë¬´ íš¨ìœ¨ì´ ë” ë†’ì•˜ê³ , ì´ë²ˆ ì˜¨ë¼ì¸ ìˆ˜ì—…ì„ í†µí•´ ì¬íƒê·¼ë¬´ê°€ ë‚´ê²Œ ë” ë§ì§€ ì•Šì„ê¹Œ í•˜ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.

í˜ì–´í”„ë¡œê·¸ë˜ë° ì§„í–‰ë„ ê°•ì˜ì‹¤ì—ì„œë³´ë‹¤ ì›í™œíˆ ì§„í–‰ë˜ì—ˆë‹¤. 

í˜ì–´ì¸ ì›ì°½ë‹˜ê³¼ ë””ìŠ¤ì½”ë“œ í™”ë©´ ê³µìœ ë¥¼ í†µí•´ í”„ë¡œì íŠ¸ì— ëŒ€í•´ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ê³  ì„œë¡œì˜ ì½”ë“œë¥¼ ë¦¬ë·°, í•©ë³‘í•˜ëŠ” ê²ƒì´ ì•ì„  ì´í‹€ì˜ í˜ì–´í”„ë¡œê·¸ë˜ë° ë³´ë‹¤ ë” ì˜ë˜ì—ˆë‹¤. 

**-ë°°ìš´ ê²ƒ**

Review-Movie-User ëª¨ë¸ì˜ ê´€ê³„ë¥¼ ì •ë¦¬í•˜ë©° 1:N  or N:M ê´€ê³„ì˜ ëª¨ë¸ë“¤ì´ ì„œë¡œ ì–´ë–¤ ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ëŠ”ì§€ ì •ë¦¬ê°€ ë˜ì—ˆë‹¤.